!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.wechatPreview=e()}(this,function(){"use strict";function t(t,e){var i,n={};for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}function e(t){var e=t.toLowerCase().replace(/ /g,"");return e}function i(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}function n(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function r(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function s(t){return t=t.replace(/(\w+)([\w\s#!:,.?+=&%@!\-\/]+)?/g,function(t){return'<span class="wcp-en">'+t+"</span>"})}function a(t,e,i){return t=document.createElement(t),e&&(t.className=e),i&&i.appendChild(t),t}function p(i){if(!(this instanceof p))throw new TypeError("wechatPreview constructor cannot be called as a function.");if(i=t({container:!1},i),i.container?(this.el=a("div","wcp"),this.main=a("div","wcp-main",this.el),this.postWrapper=a("div","wcp-post-wrapper wcp-empty",this.main),this.timestamp=a("div","wcp-timestamp",this.postWrapper)):i.container||(this.el=a("div"),this.postWrapper=a("div",!1,this.el)),this.contentWrapper=a("div","wcp-content-wrapper",this.postWrapper),i.container||n(this.contentWrapper,"wcp-gallery"),"object"==typeof i.container&&i.container.width&&i.container.height)"number"==typeof i.container.width&&"number"==typeof i.container.height&&(i.container.width=i.container.width+"px",i.container.minHeight=i.container.height+"px"),this.el.style.width=i.container.width,this.el.style.minHeight=i.container.height;else if("string"==typeof i.container)for(var r in c)c.hasOwnProperty(r)&&r==e(i.container)&&(this.el.style.width=c[r].width,this.el.style.minHeight=c[r].height);else if("boolean"!=typeof i.container)throw new TypeError("Container object contains invalid values")}var c={iphone4:{height:"480px",width:"320px"},iphone5:{height:"568px",width:"320px"},iphone6:{height:"667px",width:"375px"},iphone6plus:{height:"736px",width:"414px"}};return p.prototype.article=function(t,e){var i=a("div","wcp-article",e);if(t.shadow)n(i,"wcp-shadow"),this.shadowContent=a("div","wcp-shadow-content",i);else{var r=a("div","wcp-article-title",i),p=a("p",!1,r),c=a("span","wcp-article-date",i),o=a("div","wcp-article-image",i),h=a("div","wcp-article-description",i),l=a("div","wcp-read-all",i),w=a("span",!1,l);if(t){p.innerHTML=s(t.title),c.innerHTML=this.articleDate;var d=a("img",!1,o);t.image&&d.setAttribute("src",t.image),h.innerHTML=t.description,w.innerHTML="阅读原文"}else if(!t)for(var g=0;3>g;g++)a("div","wcp-text-line",h)}return i},p.prototype.generate=function(e){var s={postTime:new Date,articles:[]};if(e=t(s,e),e.articles)for(var a=0;a<e.articles.length;a++)this.previous?this.previous&&(e.articles[a]=t(this.previous.articles[a],e.articles[a]),e=t(this.previous,e)):e.articles[a]=t({title:"微博正文",description:"摘要",image:null,shadow:!1},e.articles[a]);if(e.postTime){var p=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],c=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],o=new Date(e.postTime),h=o.getDate(),l=new Date,w=l.getDate(),d=o.getDay(),g=l.getDay(),f=h+"日",u=w-h,m=p[d],v=o.getMonth(),y=l.getMonth(),x=c[v],D=o.getFullYear(),b=("0"+o.getHours()).slice(-2),L=("0"+o.getMinutes()).slice(-2),W=b+":"+L;w==h&&v==y?this.postDate=W:d==g-1&&7>u?this.postDate="昨天 "+W:7>u&&u>0?this.postDate=m+" "+W:this.postDate=D+"年"+x+f+" "+W,this.articleDate||(this.articleDate=x+f),this.timestamp&&(this.timestamp.innerHTML=this.postDate)}if(0==e.articles.length&&(n(this.postWrapper,"wcp-empty"),this.emptyArticle=this.article(!1,this.contentWrapper),n(this.emptyArticle,"wcp-single")),e.articles.length>0){r(this.postWrapper,"wcp-empty"),e.articles.length>1&&r(this.contentWrapper,"wcp-gallery");for(var a=0;a<e.articles.length&&9>a;a++){var T=this.article(e.articles[a],this.contentWrapper);0==a&&e.articles.length>1?n(T,"wcp-top"):0!=a||1!=e.articles.length||i(this.contentWrapper,"wcp-gallery")?n(T,"wcp-normal"):n(T,"wcp-single")}}this.previous=e},p});